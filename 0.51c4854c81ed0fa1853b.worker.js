!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,(function(e){return t[e]}).bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="wzgF")}({wzgF:function(t,e,i){"use strict";i.r(e);var o=function(t){return t[t.ADDED=0]="ADDED",t[t.MODIFIED=1]="MODIFIED",t[t.REMOVED=2]="REMOVED",t}({});class n{constructor(t,e,i,n,s,a,r){this.id=t,this.eta=e,this.gender=i,this.radianOffset=n,this.rotationCenter=s,this.rotationDirection=a,this.rotationRadius=r,this.location={lat:0,lng:0},this.state=o.ADDED}}let s=(()=>{class t{static deserialize(t){const e=new Array,i=new DataView(t);let n,s=0;const a=t.byteLength;for(;s<a;)n=i.getUint8(s),s++,n===o.REMOVED?(e.push({state:n,id:i.getUint32(s)}),s+=4):(e.push({state:n,id:i.getUint32(s),eta:i.getUint32(s+4),gender:i.getUint8(s+8),location:{lat:i.getFloat64(s+9),lng:i.getFloat64(s+17)}}),s+=25);return e}static serialize(e){let i=0;e.forEach(e=>{i+=e.state===o.REMOVED?t.PERSON_DELETED_SIZE:t.PERSON_FULL_SIZE});const n=new ArrayBuffer(i),s=new DataView(n);let a=0;return e.forEach(t=>{s.setUint8(a,t.state),a++,s.setUint32(a,t.id),a+=4,t.state!==o.REMOVED&&(s.setUint32(a,t.eta),a+=4,s.setUint8(a,t.gender),a++,s.setFloat64(a,t.location.lat),a+=8,s.setFloat64(a,t.location.lng),a+=8)}),n}}return t.PERSON_DELETED_SIZE=5,t.PERSON_FULL_SIZE=t.PERSON_DELETED_SIZE+4+1+8+8,t})();class a{constructor(){this.idCounter=0,this.people=new Array,this.timeoutId=0}static setLocation(t,e){t.location.lat=t.rotationCenter.lat+Math.sin(e+t.radianOffset)*t.rotationRadius,t.location.lng=t.rotationDirection?t.rotationCenter.lng-Math.cos(e+t.radianOffset)*t.rotationRadius:t.rotationCenter.lng+Math.cos(e+t.radianOffset)*t.rotationRadius}initialize(t,e){this.options=t,this.sendPeople=e,this.rotationHalfTime=.5*this.options.rotationTime;const i=this.getRadians();for(let n=0;n<this.options.peopleMinCount;n++)this.people.push(this.createPerson(i,0));const o=s.serialize(this.people);this.sendPeople(o),this.movePeople()}createPerson(t,e){const i=new n(this.idCounter++,Date.now()+e+Math.random()*this.options.peopleLifetimeAddition,this.idCounter%3,Math.random()*(Math.PI+Math.PI),{lat:this.options.startLocation.lat+Math.random()*this.options.spreadRadius,lng:this.options.startLocation.lng+Math.random()*this.options.spreadRadius},this.idCounter%2==0,this.options.rotationMaxRadius*Math.random());return a.setLocation(i,t),i}getRadians(){return Date.now()%this.options.rotationTime/this.rotationHalfTime*Math.PI}movePeople(){clearTimeout(this.timeoutId);const t=Date.now(),e=this.getRadians();let i=0;if(this.people.forEach(n=>{n.eta<t?n.state=o.REMOVED:(a.setLocation(n,e),n.state=o.MODIFIED,i++)}),i<this.options.peopleMinCount)for(let o=0;o<this.options.peopleBatchSize;o++)this.people.push(this.createPerson(e,this.options.peopleMinLifetime));const n=s.serialize(this.people);this.sendPeople(n),this.people=this.people.filter(t=>t.state!==o.REMOVED),this.timeoutId=setTimeout(()=>this.movePeople(),this.options.moveDelay)}}const r=new a;addEventListener("message",({data:t})=>{r.initialize(t,t=>postMessage(t,[t]))})}});